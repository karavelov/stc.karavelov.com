{% extends 'base.html' %}
{% block content %}

{% if request.user.is_superuser %}

<div class="row">
    <div class="col-lg-12 grid-margin stretch-card">
        <div class="card">
            <div class="card-body">
                <h4 class="card-title">–ì–µ–æ–≥—Ä–∞—Ñ—Å–∫–∏ –∞–Ω–∞–ª–∏–∑ –Ω–∞ —Å–∏–≥–Ω–∞–ª–∏—Ç–µ</h4>

                <!-- üîπ –§–∏–ª—Ç—Ä–∏ –∑–∞ –∞–Ω–∞–ª–∏–∑ -->
                <form method="GET" class="d-flex flex-wrap align-items-center">
                    <!-- –§–∏–ª—Ç—ä—Ä –ø–æ –ø—Ä–µ–¥–≤–∞—Ä–∏—Ç–µ–ª–Ω–æ –∑–∞–¥–∞–¥–µ–Ω –ø–µ—Ä–∏–æ–¥ -->
                    <div class="form-group mb-2 mr-2" style="flex: 1;">
                        <label for="filter_period" class="sr-only">–§–∏–ª—Ç—ä—Ä –ø–æ –ø–µ—Ä–∏–æ–¥</label>
                        <select name="filter_period" id="filter_period" class="form-control"
                            style="width: 100%; height: 42px;">
                            <option value="">–ò–∑–±–µ—Ä–µ—Ç–µ –ø–µ—Ä–∏–æ–¥</option>
                            <option value="1d" {% if filter_period == "1d" %}selected{% endif %}>–ü–æ—Å–ª–µ–¥–Ω–∏—Ç–µ 24 —á–∞—Å–∞</option>
                            <option value="1w" {% if filter_period == "1w" %}selected{% endif %}>–ü–æ—Å–ª–µ–¥–Ω–∞—Ç–∞ —Å–µ–¥–º–∏—Ü–∞</option>
                            <option value="1m" {% if filter_period == "1m" %}selected{% endif %}>–ü–æ—Å–ª–µ–¥–Ω–∏—è –º–µ—Å–µ—Ü</option>
                            <option value="3m" {% if filter_period == "3m" %}selected{% endif %}>–ü–æ—Å–ª–µ–¥–Ω–∏—Ç–µ 3 –º–µ—Å–µ—Ü–∞</option>
                            <option value="6m" {% if filter_period == "6m" %}selected{% endif %}>–ü–æ—Å–ª–µ–¥–Ω–∏—Ç–µ 6 –º–µ—Å–µ—Ü–∞</option>
                            <option value="12m" {% if filter_period == "12m" %}selected{% endif %}>–ü–æ—Å–ª–µ–¥–Ω–∏—Ç–µ 12 –º–µ—Å–µ—Ü–∞</option>
                            <option value="24m" {% if filter_period == "24m" %}selected{% endif %}>–ü–æ—Å–ª–µ–¥–Ω–∏—Ç–µ 24 –º–µ—Å–µ—Ü–∞</option>
                        </select>
                    </div>

                    <!-- –§–∏–ª—Ç—ä—Ä –ø–æ –∫–æ–Ω–∫—Ä–µ—Ç–Ω–∏ –¥–∞—Ç–∏ -->
                    <div class="form-group mb-2 mr-2" style="flex: 1; position: relative;">
                        <label for="start_date" class="sr-only">–î–∞—Ç–∞ –æ—Ç</label>
                        <input type="date" id="start_date" name="start_date" class="form-control datepicker"
                            placeholder="–î–∞—Ç–∞ –æ—Ç" value="{{ start_date }}" style="width: 100%; height: 42px;">
                    </div>

                    <div class="form-group mb-2 mr-2" style="flex: 1; position: relative;">
                        <label for="end_date" class="sr-only">–î–∞—Ç–∞ –¥–æ</label>
                        <input type="date" id="end_date" name="end_date" class="form-control datepicker"
                            placeholder="–î–∞—Ç–∞ –¥–æ" value="{{ end_date }}" style="width: 100%; height: 42px;">
                    </div>

                    <!-- –ë—É—Ç–æ–Ω –∑–∞ —Ñ–∏–ª—Ç—Ä–∏—Ä–∞–Ω–µ -->
                    <button type="submit" class="btn btn-dark mb-2 mr-2" style="height: 42px;">–§–∏–ª—Ç—Ä–∏—Ä–∞–Ω–µ</button>
                    
                    <!-- –ù—É–ª–∏—Ä–∞–Ω–µ –Ω–∞ —Ñ–∏–ª—Ç—Ä–∏—Ç–µ -->
                    <a href="{% url 'geographic_analysis' %}" class="btn btn-secondary mb-2" style="height: 42px;">–ù—É–ª–∏—Ä–∞–Ω–µ</a>
                </form>

                <br>
                
                <!-- üîπ –°—ä–æ–±—â–µ–Ω–∏–µ –∑–∞ –ø–µ—Ä–∏–æ–¥–∞ –Ω–∞ –∞–Ω–∞–ª–∏–∑–∞ -->
                <div class="alert alert-info text-center">
                    <strong>–ê–Ω–∞–ª–∏–∑—ä—Ç –µ –±–∞–∑–∏—Ä–∞–Ω –Ω–∞:</strong> {{ filter_message }}
                </div>

                {% if graphic %}
                <div class="text-center">
                    <img src="data:image/png;base64,{{ graphic }}" class="img-fluid" alt="–ì—Ä–∞—Ñ–∏–∫–∞ –Ω–∞ –∞–Ω–∞–ª–∏–∑–∞">
                </div>
                {% else %}
                <p class="text-center text-danger font-weight-bold">–ù—è–º–∞ –Ω–∞–ª–∏—á–Ω–∏ –¥–∞–Ω–Ω–∏ –∑–∞ —Ç–æ–∑–∏ –ø–µ—Ä–∏–æ–¥.</p>
                {% endif %}
            </div>
        </div>
    </div>
</div>

{% else %}
<div class="alert alert-danger" role="alert">
    <h4 class="alert-heading">–î–æ—Å—Ç—ä–ø –æ—Ç–∫–∞–∑–∞–Ω!</h4>
    <p>–¢–∞–∑–∏ —Å—Ç—Ä–∞–Ω–∏—Ü–∞ –µ –¥–æ—Å—Ç—ä–ø–Ω–∞ —Å–∞–º–æ –∑–∞ –∞–¥–º–∏–Ω–∏—Å—Ç—Ä–∞—Ç–æ—Ä–∏.</p>
</div>
{% endif %}

{% endblock %}
